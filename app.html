<!DOCTYPE html>
<html {{ HTML_ATTRS }}>
<head {{ HEAD_ATTRS }}>
  {{ HEAD }}
</head>
<body {{ BODY_ATTRS }}>
{{ APP }}
<!-- Yandex.Maps -->
<script src="https://api-maps.yandex.ru/2.1/?apikey=e65fea9d-e8a0-479d-b21a-35637fdc6c6c&lang=ru_RU&init=onload" type="text/javascript"></script>
<!-- /Yandex.Map -->
<!-- Yandex.Metrika -->
<script type="text/javascript" >
  (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
  (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
  ym(54496129, "init", {
    clickmap:true,
    trackLinks:true,
    accurateTrackBounce:true,
    webvisor:true
  });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/54496129" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika -->
<!-- Jivosite -->
<script src="//code.jivosite.com/widget.js" jv-id="H95FUE1JmR" async></script>
<script>
  function jivo_onLoadCallback(){
    jivo_api.setUserToken(yaCounter54496129.getClientID());
  }
</script>
<!-- /Jivosite -->
<script>
  if (window.location.pathname === '/perm/service' || window.location.pathname === '/perm') {
    var tag_body = document.getElementsByTagName("body")[0];
    // YClients
    var yclients = document.createElement("script");
    yclients.type = "text/javascript";
    yclients.src = "https://w385915.yclients.com/widgetJS";
    yclients.charset = "UTF-8";
    var page = '';
    switch (window.location.pathname) {
      case '/perm/service':
        page = 'service';
        break;
      case '/perm':
        page = 'main';
        break;
    }
    var yc_button = document.createElement("a");
    yc_button.href = "#";
    yc_button.className = "ms_booking yc_button event";
    yc_button.id = page + "__online-appointment__button";
    yc_button.innerHTML = "Запись на сервис";
    yc_button.setAttribute("onclick", "sendGoals('online-zapis');");
    // /YClients
    tag_body.appendChild(yclients);
    tag_body.appendChild(yc_button);
  }
  function sendGoals(goal) {
    if (goal) {
      let ym_ids = getCountersIds();
      let goalArr = goal.match(/^(.+?):(.+?)$/);
      let target_goal = goalArr === null ? goal : goalArr[2];
      ym_ids.forEach(function (item, i, arr) {
        window["yaCounter" + item].reachGoal(target_goal);
      });
    }
  }
  function getCountersIds() {
    var id_list = [];
    window.ym.a.forEach(function(item){
      id_list.push(item[0]);
    });
    return id_list;
  }
</script>
</body>
</html>
